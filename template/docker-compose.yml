version: '2'

services:
  mongo:
    image: mongo
    restart: always
    environment:
        # provide your credentials here
        - MONGO_INITDB_ROOT_USERNAME=RodaSrvMongoUser
        - MONGO_INITDB_ROOT_PASSWORD=RodaSrvMongoPwd
    ports:
      - "RodaSrvMongoPort:27017"
    volumes:
      - RodaSrvMongoDir/data/db:/data/db
      - RodaSrvMongoDir/data/configdb:/data/configdb

  mongo-express:
    image: mongo-express
    restart: always
    ports:
      - "8081:8081"
    environment:
      - ME_CONFIG_MONGODB_ADMINUSERNAME=RodaSrvMongoUser
      - ME_CONFIG_MONGODB_ADMINPASSWORD=RodaSrvMongoPwd

  dyndoc-ruby:
    build:
      context: DockerFiles
      dockerfile: Dockerfile-dyndoc
    image: rcqls/dyndoc-ruby-DyndocRubyUbuntu

  website:
    build:
      context: DockerFiles
      dockerfile: Dockerfile-website
    image: rcqls/website-DyndocRubyUbuntu
    restart: always
    volumes:
      - RodaSrvPublic:/home/ubuntu/RodaSrv/public
      - RodaSrvTools:/home/ubuntu/RodaSrv/.tools
      - RodaSrvDyndocLibrary:/home/ubuntu/dyndoc-library
      - RodaSrvDyndocWorld:/home/ubuntu/.dyndoc-world
      - ../guest-tools:/home/ubuntu/tools
    ports:
      - RodaSrvPort:9294
    tty: true
    depends_on:
      - mongo
      - mongo-express